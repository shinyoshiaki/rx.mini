{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../src/extensions/buffer/index.ts"],"names":[],"mappings":";;;;AAAA,4DAA+B;AAE/B,SAAgB,MAAM,CAAkB,MAAc,EAAE,KAAe;IACrE,IAAM,UAAU,GAAG,IAAI,cAAK,EAAK,CAAC;IAClC,IAAM,IAAI,GAAQ,EAAE,CAAC;IACrB,IAAI,MAAM,GAAG,KAAK,CAAC;IACnB,KAAK,CAAC,SAAS,CAAC;QAAC,WAAI;aAAJ,UAAI,EAAJ,qBAAI,EAAJ,IAAI;YAAJ,sBAAI;;QACnB,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,EAAE;YACrC,IAAI,CAAC,OAAO,CAAC,UAAC,CAAC,IAAK,OAAA,UAAU,CAAC,OAAO,OAAlB,UAAU,EAAY,CAAC,GAAvB,CAAwB,CAAC,CAAC;YAC9C,MAAM,GAAG,IAAI,CAAC;SACf;QACD,IAAI,MAAM,EAAE;YACV,UAAU,CAAC,OAAO,OAAlB,UAAU,EAAY,CAAC,EAAE;SAC1B;aAAM;YACL,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SACd;IACH,CAAC,CAAC,CAAC;IAEK,IAAA,SAAS,GAAsB,UAAU,UAAhC,EAAE,SAAS,GAAW,UAAU,UAArB,EAAE,IAAI,GAAK,UAAU,KAAf,CAAgB;IAClD,OAAO,EAAE,SAAS,WAAA,EAAE,SAAS,WAAA,EAAE,IAAI,MAAA,EAAE,CAAC;AACxC,CAAC;AAlBD,wBAkBC","sourcesContent":["import Event from \"../../core\";\n\nexport function Buffer<T extends any[]>(length: number, event: Event<T>) {\n  const observable = new Event<T>();\n  const pool: T[] = [];\n  let fulled = false;\n  event.subscribe((...e) => {\n    if (!fulled && pool.length === length) {\n      pool.forEach((e) => observable.execute(...e));\n      fulled = true;\n    }\n    if (fulled) {\n      observable.execute(...e);\n    } else {\n      pool.push(e);\n    }\n  });\n\n  const { subscribe, asPromise, once } = observable;\n  return { subscribe, asPromise, once };\n}\n"]}